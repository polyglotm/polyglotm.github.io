---
layout: post
title: "[MEANI-Stack] - #10 (Node & Express) User API Test작성"
date: '2016-03-06T00:43:00.000-08:00'
author: Jaeyoung Lee
tags:
- Pet-Project
- "*MEANI-Stack"
modified_time: '2016-03-06T00:43:09.381-08:00'
thumbnail: https://1.bp.blogspot.com/-qLwPQhUNmZM/Vtp8gXOUMCI/AAAAAAAAD5Q/aSHqFQ-YtWo/s72-c/JasmineJS_logo.png
blogger_id: tag:blogger.com,1999:blog-5872989675159532416.post-640224802906386624
blogger_orig_url: http://polyglot-m.blogspot.com/2016/03/meani-stack-10-node-express-user-api.html
---

<h2>[MEANI-Stack] - #10 (Node &amp; Express) User API Test작성</h2><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-qLwPQhUNmZM/Vtp8gXOUMCI/AAAAAAAAD5Q/aSHqFQ-YtWo/s1600/JasmineJS_logo.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="174" src="https://1.bp.blogspot.com/-qLwPQhUNmZM/Vtp8gXOUMCI/AAAAAAAAD5Q/aSHqFQ-YtWo/s640/JasmineJS_logo.png" width="640" /></a></div><br /><br />API test를 하기위해 jasmine Framework를 선택 하였습니다.<br /><br />jasmine framework는 javascript test framework로써<br />mochaJS, chaiJS 와 같은 테스트 프레임워크들 사이에 있습니다.<br /><br />과거 jasmine 1.x시절에는 done() callback메소드<br />즉 promise스펙을 지원하지 않아<br />promise 스펙을 지원하는 mochaJS가 압도적으로 우세했지만<br /><br />jasmine 2.0에서 비동기 콜백 함수 지원, 즉 promise spec을 구현함에 따라<br />mochaJS&nbsp;+ chaiJS promise 조합으로 사용하던 스택과 &nbsp;동등한 위치가 되었지요.<br /><br />이에따라 angularJS팀에서 만든 protractor 테스트 프레임워크가<br />기존에 mocha와 jasmine을 모두 지원하다가<br />공식적으로 mocha를 더이상 지원하지 않겠다고 발표하면서<br />jasmine의 관심도가 더 높아지게 되었습니다.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-VWJhMkriKJo/VtvqcMwmeeI/AAAAAAAAD5k/auLH7rFHUg8/s1600/2016.%2B3.%2B5.%2B03-21-42.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="204" src="https://2.bp.blogspot.com/-VWJhMkriKJo/VtvqcMwmeeI/AAAAAAAAD5k/auLH7rFHUg8/s640/2016.%2B3.%2B5.%2B03-21-42.png" width="640" /></a></div><br /><br />protractor link :&nbsp;<a href="https://angular.github.io/protractor/#/" target="_blank">https://angular.github.io/protractor/#/</a><br />mocha limited support link : <a href="https://github.com/angular/protractor/blob/master/docs/frameworks.md" target="_blank">https://github.com/angular/protractor/blob/master/docs/frameworks.md</a><br /><br /><br /><br />이번 펫 프로젝트 기술 스택이 MEANI 즉 angularJS를 사용하는만큼<br />위와같은 이유들로&nbsp;protractor를 고려하여 jasmine으로 선택하였습니다.<br /><div><br /></div>jasmine 기반으로 제작된 jasmine-node를 사용하려 해 보았으나<br />몇일간 테스트 해본결과 순수한 jasmine과의 큰 차이를 느낄수 없어<br />jasmine을 사용합니다. <br />jasmine 링크 :&nbsp;http://jasmine.github.io/<br /><br />jasmine-node 링크 :&nbsp;<a href="https://github.com/mhevery/jasmine-node/tree/Jasmine2.0" target="_blank">https://github.com/mhevery/jasmine-node/tree/Jasmine2.0</a><br /><br /><br /><br />아래 명령어로 jasmin과 request 모듈을 설치합니다.<br /><pre style="background-color: #f7f7f7; border-radius: 3px; box-sizing: border-box; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow: auto; padding: 16px; word-break: normal; word-wrap: normal;"><b>$ npm install -g jasmine<br /><span style="font-size: 13.6px; line-height: 1.45;">$ npm install -save request</span></b></pre><br /><br />jasmine으로 http request를 요청하기 위해서는 매번 XMLHttpRequest 객체를 직접 생성해야 하므로<br />request 모듈도 함께 설치해줍니다.<br />request 모듈은 simple http request를 제공해줍니다.<br /><div><br /></div><br /><br />CRUD 테스트를 작성하기 위해 아래와 같이 user controller에 remove를 추가해 줍니다.<br /><br />user.server.controller.js<br /><br /><div class="colorscripter-code" style="color: #f0f0f0; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; overflow: auto; position: relative !important;"><table cellpadding="0" cellspacing="0" class="colorscripter-code-table" style="background-color: #272727; border-radius: 4px; border: none; margin: 0; padding: 0;"><tbody><tr><td style="border-right: 2px solid #4f4f4f; padding: 6px;"><div style="color: #aaaaaa; line-height: 130%; margin: 0px; padding: 0px; text-align: right; word-break: normal;"><div style="line-height: 130%;">1</div><div style="line-height: 130%;">2</div><div style="line-height: 130%;">3</div><div style="line-height: 130%;">4</div><div style="line-height: 130%;">5</div><div style="line-height: 130%;">6</div><div style="line-height: 130%;">7</div><div style="line-height: 130%;">8</div><div style="line-height: 130%;">9</div><div style="line-height: 130%;">10</div><div style="line-height: 130%;">11</div><div style="line-height: 130%;">12</div><div style="line-height: 130%;">13</div><div style="line-height: 130%;">14</div><div style="line-height: 130%;">15</div><div style="line-height: 130%;">16</div><div style="line-height: 130%;">17</div><div style="line-height: 130%;">18</div><div style="line-height: 130%;">19</div><div style="line-height: 130%;">20</div><div style="line-height: 130%;">21</div><div style="line-height: 130%;">22</div><div style="line-height: 130%;">23</div><div style="line-height: 130%;">24</div><div style="line-height: 130%;">25</div><div style="line-height: 130%;">26</div><div style="line-height: 130%;">27</div><div style="line-height: 130%;">28</div><div style="line-height: 130%;">29</div><div style="line-height: 130%;">30</div><div style="line-height: 130%;">31</div><div style="line-height: 130%;">32</div><div style="line-height: 130%;">33</div><div style="line-height: 130%;">34</div><div style="line-height: 130%;">35</div><div style="line-height: 130%;">36</div><div style="line-height: 130%;">37</div><div style="line-height: 130%;">38</div><div style="line-height: 130%;">39</div><div style="line-height: 130%;">40</div><div style="line-height: 130%;">41</div><div style="line-height: 130%;">42</div><div style="line-height: 130%;">43</div><div style="line-height: 130%;">44</div><div style="line-height: 130%;">45</div><div style="line-height: 130%;">46</div><div style="line-height: 130%;">47</div><div style="line-height: 130%;">48</div><div style="line-height: 130%;">49</div><div style="line-height: 130%;">50</div><div style="line-height: 130%;">51</div><div style="line-height: 130%;">52</div><div style="line-height: 130%;">53</div><div style="line-height: 130%;">54</div><div style="line-height: 130%;">55</div><div style="line-height: 130%;">56</div><div style="line-height: 130%;">57</div><div style="line-height: 130%;">58</div><div style="line-height: 130%;">59</div><div style="line-height: 130%;">60</div><div style="line-height: 130%;">61</div></div></td><td style="padding: 6px 0;"><div style="color: #f0f0f0; line-height: 130%; margin: 0px; padding: 0px;"><div style="line-height: 130%; padding: 0 6px; white-space: pre;"><span style="color: #ff3399;">var</span>&nbsp;User&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;require(<span style="color: #ffd500;">'mongoose'</span>).model(<span style="color: #ffd500;">'User'</span>);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">exports.create&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #ff3399;">function</span>(req,&nbsp;res,&nbsp;next)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;<span style="color: #ff3399;">var</span>&nbsp;user&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #ff3399;">new</span>&nbsp;User(req.body);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;<span style="color: #4be6fa;">console</span>.log(req.body);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;User.count({email:&nbsp;req.body.email},</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">function</span>&nbsp;(err,&nbsp;count)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">if</span>&nbsp;(<span style="color: #0086b3;"></span><span style="color: #ff3399;">!</span>count)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user.save(<span style="color: #ff3399;">function</span>(err)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">if</span>&nbsp;(err)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.json(err);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style="color: #ff3399;">else</span>&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.json(user);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style="color: #ff3399;">else</span>&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">var</span>&nbsp;errorMessage&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #ffd500;">'User&nbsp;email&nbsp;is&nbsp;Already&nbsp;Exists'</span>;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #4be6fa;">console</span>.log(errorMessage);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.json(errorMessage);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">};</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">exports.list&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #ff3399;">function</span>(req,&nbsp;res,&nbsp;next)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;User.find({},&nbsp;<span style="color: #ff3399;">function</span>(err,&nbsp;users)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">if</span>&nbsp;(err)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">return</span>&nbsp;next(err);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style="color: #ff3399;">else</span>&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.json(users);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">};</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">exports.findUserByEmail&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #ff3399;">function</span>(req,&nbsp;res,&nbsp;next)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;User.findOne({</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;email:&nbsp;req.params.email</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;},&nbsp;<span style="color: #ff3399;">function</span>(err,&nbsp;user)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">if</span>&nbsp;(err)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #4be6fa;">console</span>.log(err);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">return</span>&nbsp;next(err);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style="color: #ff3399;">else</span>&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #4be6fa;">console</span>.log(err);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.json(user);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">exports.remove&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #ff3399;">function</span>(req,&nbsp;res,&nbsp;next)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;User.remove({</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;email:&nbsp;req.params.email</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;},&nbsp;<span style="color: #ff3399;">function</span>(err,&nbsp;user)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">if</span>&nbsp;(err)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">return</span>&nbsp;next(err);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style="color: #ff3399;">else</span>&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.json(user);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div></div><div style="font-size: 9px; font-style: italic; margin-right: 5px; margin-top: -13px; text-align: right;"><a href="http://colorscripter.com/info#e" style="color: #4f4f4f; text-decoration: none;" target="_blank">Colored by Color Scripter</a></div></td><td style="padding: 0 2px 4px 0; vertical-align: bottom;"><a href="http://colorscripter.com/info#e" style="color: white; text-decoration: none;" target="_blank"><span style="background-color: #4f4f4f; border-radius: 10px; font-size: 9px; padding: 1px; word-break: normal;">cs</span></a></td></tr></tbody></table></div><br /><br />mongoose에서 제공하는 기본 메소드들은 model.js를 사용합니다.<br />기본 제공하는 메소드 들에 대해 궁굼하다면 아래 링크를 참고하세요.<br /><a href="http://mongoosejs.com/docs/api.html#model-js" target="_blank">http://mongoosejs.com/docs/api.html#model-js</a><br /><br /><br />user.server.routes.js에 아래와같이 delete를 추가해 줍니다.<br /><br /><div class="colorscripter-code" style="color: #f0f0f0; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; overflow: auto; position: relative !important;"><table cellpadding="0" cellspacing="0" class="colorscripter-code-table" style="background-color: #272727; border-radius: 4px; border: none; margin: 0; padding: 0;"><tbody><tr><td style="border-right: 2px solid #4f4f4f; padding: 6px;"><div style="color: #aaaaaa; line-height: 130%; margin: 0px; padding: 0px; text-align: right; word-break: normal;"><div style="line-height: 130%;">1</div><div style="line-height: 130%;">2</div><div style="line-height: 130%;">3</div><div style="line-height: 130%;">4</div><div style="line-height: 130%;">5</div><div style="line-height: 130%;">6</div><div style="line-height: 130%;">7</div><div style="line-height: 130%;">8</div><div style="line-height: 130%;">9</div><div style="line-height: 130%;">10</div><div style="line-height: 130%;">11</div><div style="line-height: 130%;">12</div></div></td><td style="padding: 6px 0;"><div style="color: #f0f0f0; line-height: 130%; margin: 0px; padding: 0px;"><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;"><span style="color: #ff3399;">var</span>&nbsp;users&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;require(<span style="color: #ffd500;">'../../app/controllers/users.server.controller.js'</span>);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">module.exports&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #ff3399;">function</span>(app)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;app.route(<span style="color: #ffd500;">'/users'</span>)</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;.post(users.create)</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;.get(users.list);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;app.route(<span style="color: #ffd500;">'/users/:email'</span>)</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;.get(users.findUserByEmail)</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;.<span style="color: #ff3399;">delete</span>(users.remove);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div></div><div style="font-size: 9px; font-style: italic; margin-right: 5px; margin-top: -13px; text-align: right;"><a href="http://colorscripter.com/info#e" style="color: #4f4f4f; text-decoration: none;" target="_blank">Colored by Color Scripter</a></div></td><td style="padding: 0 2px 4px 0; vertical-align: bottom;"><a href="http://colorscripter.com/info#e" style="color: white; text-decoration: none;" target="_blank"><span style="background-color: #4f4f4f; border-radius: 10px; font-size: 9px; padding: 1px; word-break: normal;">cs</span></a></td></tr></tbody></table></div><br /><br /><br />이제 본격적으로 jasmine을 사용하기 위해 아래 명령어를 입력합니다.<br /><br /><pre style="background-color: #f7f7f7; border-radius: 3px; box-sizing: border-box; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow: auto; padding: 16px; word-break: normal; word-wrap: normal;"><b>$ jasmine init<br /><span style="font-size: 13.6px; line-height: 1.45;">$ jasmine examples</span></b></pre><br />위 명령어들을 실행하면 spec directory가 생성되고 간단한 예제가 생성됩니다.<br />spec/<br />&nbsp;-helpers/<br />&nbsp;-jasmine_examples/<br />&nbsp;-support/<br /><br class="Apple-interchange-newline" />최종적으로 위와 같은 directory가 생성되는데<br /><div>저는 여기에 모델들을 테스트 하기 위한 코드를 모아놓은 models directory와&nbsp;</div><div>순수하게 jamsine을 테스트를 해보기위한 test directory두개를 더 생성했습니다.</div><br /><br class="Apple-interchange-newline" />spec/<br />&nbsp;-helpers/<br />&nbsp;-jasmine_examples/<br />&nbsp;-support/<br /><div>&nbsp;-models/</div><div>&nbsp;-test/</div><div><br /></div><div><br /></div><div>그리고 models 안에 user.model.spec.js를 생성하고 아래와 같이 코드를 작성하였습니다.</div><div><br /></div><div><div class="colorscripter-code" style="color: #f0f0f0; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; overflow: auto; position: relative !important;"><table cellpadding="0" cellspacing="0" class="colorscripter-code-table" style="background-color: #272727; border-radius: 4px; border: none; margin: 0; padding: 0;"><tbody><tr><td style="border-right: 2px solid #4f4f4f; padding: 6px;"><div style="color: #aaaaaa; line-height: 130%; margin: 0px; padding: 0px; text-align: right; word-break: normal;"><div style="line-height: 130%;">1</div><div style="line-height: 130%;">2</div><div style="line-height: 130%;">3</div><div style="line-height: 130%;">4</div><div style="line-height: 130%;">5</div><div style="line-height: 130%;">6</div><div style="line-height: 130%;">7</div><div style="line-height: 130%;">8</div><div style="line-height: 130%;">9</div><div style="line-height: 130%;">10</div><div style="line-height: 130%;">11</div><div style="line-height: 130%;">12</div><div style="line-height: 130%;">13</div><div style="line-height: 130%;">14</div><div style="line-height: 130%;">15</div><div style="line-height: 130%;">16</div><div style="line-height: 130%;">17</div><div style="line-height: 130%;">18</div><div style="line-height: 130%;">19</div><div style="line-height: 130%;">20</div><div style="line-height: 130%;">21</div><div style="line-height: 130%;">22</div><div style="line-height: 130%;">23</div><div style="line-height: 130%;">24</div><div style="line-height: 130%;">25</div><div style="line-height: 130%;">26</div><div style="line-height: 130%;">27</div><div style="line-height: 130%;">28</div><div style="line-height: 130%;">29</div><div style="line-height: 130%;">30</div><div style="line-height: 130%;">31</div><div style="line-height: 130%;">32</div><div style="line-height: 130%;">33</div><div style="line-height: 130%;">34</div><div style="line-height: 130%;">35</div><div style="line-height: 130%;">36</div><div style="line-height: 130%;">37</div><div style="line-height: 130%;">38</div><div style="line-height: 130%;">39</div><div style="line-height: 130%;">40</div><div style="line-height: 130%;">41</div><div style="line-height: 130%;">42</div><div style="line-height: 130%;">43</div><div style="line-height: 130%;">44</div><div style="line-height: 130%;">45</div><div style="line-height: 130%;">46</div><div style="line-height: 130%;">47</div><div style="line-height: 130%;">48</div><div style="line-height: 130%;">49</div><div style="line-height: 130%;">50</div><div style="line-height: 130%;">51</div><div style="line-height: 130%;">52</div><div style="line-height: 130%;">53</div><div style="line-height: 130%;">54</div><div style="line-height: 130%;">55</div><div style="line-height: 130%;">56</div><div style="line-height: 130%;">57</div><div style="line-height: 130%;">58</div><div style="line-height: 130%;">59</div><div style="line-height: 130%;">60</div><div style="line-height: 130%;">61</div><div style="line-height: 130%;">62</div><div style="line-height: 130%;">63</div><div style="line-height: 130%;">64</div><div style="line-height: 130%;">65</div><div style="line-height: 130%;">66</div><div style="line-height: 130%;">67</div><div style="line-height: 130%;">68</div><div style="line-height: 130%;">69</div><div style="line-height: 130%;">70</div><div style="line-height: 130%;">71</div><div style="line-height: 130%;">72</div><div style="line-height: 130%;">73</div></div></td><td style="padding: 6px 0;"><div style="color: #f0f0f0; line-height: 130%; margin: 0px; padding: 0px;"><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;"><span style="color: #ff3399;">var</span>&nbsp;request&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;require(<span style="color: #ffd500;">'request'</span>);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;"><span style="color: #999999;">//&nbsp;jasmine.getEnv().defaultTimeoutInterval&nbsp;=&nbsp;500;</span></div><div style="line-height: 130%; padding: 0 6px; white-space: pre;"><span style="color: #ff3399;">var</span>&nbsp;r&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;request.defaults({<span style="color: #ffd500;">'proxy'</span>:<span style="color: #ffd500;">'http://localhost:4000/users'</span>});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;"><span style="color: #ff3399;">var</span>&nbsp;requestDefault&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #ffd500;">'http://localhost:4000'</span>;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">describe(<span style="color: #ffd500;">'User&nbsp;Model&nbsp;Test'</span>,&nbsp;<span style="color: #ff3399;">function</span>()&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;<span style="color: #ff3399;">var</span>&nbsp;email&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #ffd500;">'test_'</span>&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">+</span>&nbsp;Math.floor(Math.random()<span style="color: #0086b3;"></span><span style="color: #ff3399;">*</span><span style="color: #c10aff;">10000</span>)&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">+</span>&nbsp;<span style="color: #ffd500;">'@gmail.com'</span>;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;<span style="color: #ff3399;">var</span>&nbsp;form&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;email&nbsp;:&nbsp;email,</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;password&nbsp;:&nbsp;<span style="color: #ffd500;">'12345678'</span>,</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;role&nbsp;:&nbsp;<span style="color: #ffd500;">'User'</span></div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;<span style="color: #ff3399;">var</span>&nbsp;responseCallback&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #ff3399;">function</span>(err,&nbsp;res,&nbsp;body,&nbsp;debug)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">if</span>&nbsp;(debug)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #4be6fa;">console</span>.log(res);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;expect(res.statusCode).toEqual(<span style="color: #c10aff;">200</span>);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff3399;">if</span>&nbsp;(res.statusCode&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">!</span><span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span><span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;<span style="color: #c10aff;">200</span>){</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #4be6fa;">console</span>.log(res.statusCode);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #4be6fa;">console</span>.log(body);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;};</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;it(<span style="color: #ffd500;">'user&nbsp;list&nbsp;get'</span>,&nbsp;<span style="color: #ff3399;">function</span>(done)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;request.get(requestDefault&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">+</span>&nbsp;<span style="color: #ffd500;">'/users'</span>,&nbsp;<span style="color: #ff3399;">function</span>(err,&nbsp;res,&nbsp;body)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseCallback(err,&nbsp;res,&nbsp;body);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done();</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;it(<span style="color: #ffd500;">'user&nbsp;create'</span>,&nbsp;<span style="color: #ff3399;">function</span>(done)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;request.post({</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;:&nbsp;requestDefault&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">+</span>&nbsp;<span style="color: #ffd500;">'/users'</span>,</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form&nbsp;:&nbsp;form,</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;headers&nbsp;:&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ffd500;">'Content-Type'</span>&nbsp;:&nbsp;<span style="color: #ffd500;">'application/json'</span></div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;<span style="color: #ff3399;">function</span>(err,&nbsp;res,&nbsp;body)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseData&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;JSON.parse(body);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expect(responseData.email).toEqual(email);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseCallback(err,&nbsp;res,&nbsp;body);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done();</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;it(<span style="color: #ffd500;">'user&nbsp;read'</span>,&nbsp;<span style="color: #ff3399;">function</span>(done)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;request.get(requestDefault&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">+</span>&nbsp;<span style="color: #ffd500;">'/users/'</span>&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">+</span>&nbsp;email,&nbsp;<span style="color: #ff3399;">function</span>(err,&nbsp;res,&nbsp;body)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseData&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;JSON.parse(body);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expect(responseData.email).toEqual(email);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseCallback(err,&nbsp;res,&nbsp;body);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done();</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;it(<span style="color: #ffd500;">'user&nbsp;delete'</span>,&nbsp;<span style="color: #ff3399;">function</span>(done)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;request.del(requestDefault&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">+</span>&nbsp;<span style="color: #ffd500;">'/users/'</span>&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">+</span>&nbsp;email,&nbsp;<span style="color: #ff3399;">function</span>(err,&nbsp;res,&nbsp;body)&nbsp;{</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseData&nbsp;<span style="color: #0086b3;"></span><span style="color: #ff3399;">=</span>&nbsp;JSON.parse(body);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #999999;">//&nbsp;console.log(body);</span></div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expect(responseData.n).toEqual(<span style="color: #c10aff;">1</span>);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseCallback(err,&nbsp;res,&nbsp;body);</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done();</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;&nbsp;});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">});</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div><div style="line-height: 130%; padding: 0 6px; white-space: pre;">&nbsp;</div></div><div style="font-size: 9px; font-style: italic; margin-right: 5px; margin-top: -13px; text-align: right;"><a href="http://colorscripter.com/info#e" style="color: #4f4f4f; text-decoration: none;" target="_blank">Colored by Color Scripter</a></div></td><td style="padding: 0 2px 4px 0; vertical-align: bottom;"><a href="http://colorscripter.com/info#e" style="color: white; text-decoration: none;" target="_blank"><span style="background-color: #4f4f4f; border-radius: 10px; font-size: 9px; padding: 1px; word-break: normal;">cs</span></a></td></tr></tbody></table></div></div><br /><br /><br /><br />실행하는법은 project directory에서 jasmine 명령어를 입력하면 됩니다.<br />이때 주의할점은 junit처럼 가상서버를 자동으로 생성해서 테스트를 진행하는게 아니라서<br />node server가 실행되지 않은 상태에서 테스트를 실행할경우 request요청은 모두 fail이 됩니다.<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-0N9ErY5fEvQ/VtvqlGeMFMI/AAAAAAAAD5o/Byucb5VamT0/s1600/2016.%2B3.%2B6.%2B05-28-50.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="134" src="https://2.bp.blogspot.com/-0N9ErY5fEvQ/VtvqlGeMFMI/AAAAAAAAD5o/Byucb5VamT0/s640/2016.%2B3.%2B6.%2B05-28-50.png" width="640" /></a></div><br /><br />훌륭합니다. 0.066초 만에 user.model CRUD를 모두 테스트 완료하였습니다.<br />단순계산으로 해보면 모델이 10개일경우에도 1초 미만에 테스트가 가능해지니<br />테스트 작성이 조금 번거로울지 몰라도 1시간에 10번씩 테스트해도 아무런 부담이 없어졌습니다.<br /><br /><br /><br />작업의 마무리는 커밋!<br /><a href="https://github.com/polyglotm/PP-MEANI-stack-back-end" target="_blank">https://github.com/polyglotm/PP-MEANI-stack-back-end</a><br /><br /><br />포스트의 마무리는 애자일 보드 확인!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-VugahArt0zk/Vtvsdk0NH7I/AAAAAAAAD54/aX8mN8ffm6c/s1600/2016.%2B3.%2B6.%2B05-37-41.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="292" src="https://4.bp.blogspot.com/-VugahArt0zk/Vtvsdk0NH7I/AAAAAAAAD54/aX8mN8ffm6c/s640/2016.%2B3.%2B6.%2B05-37-41.png" width="640" /></a></div><br /><br />다음 태스크는 <u><b>(Angular 2) 회원가입 UI 작성</b></u>&nbsp;으로 선택 되었습니다.<br />드디어! 고대하던 Angular 2를 본격적으로 시작할수 있게 되었네요!<br /><br />한가지 고민이 있다면 ionic2를 위해서 굳이 따로 mobile UI를 따로 만들어야 하는건가 생각이 듭니다.<br />가급적이면 웹에서 mobile대응을 하고<br />ionic은 말그대로 컨버팅 되는것에 중점을 둘까 생각중입니다.<br /><br />물론 &nbsp;ionic2가 컨버팅이 잘 된다면요...